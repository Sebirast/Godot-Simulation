[gd_scene load_steps=5 format=2]

[ext_resource path="res://tank.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]
script/source = "extends RigidBody2D

const WALK_ACCEL = 500.0
const WALK_MAX_VELOCITY = 140.0

var collisionShapes = [$CollisionPolygon2D, $CollisionShape2D, $CollisionShape2D2, $CollisionShape2D3, $CollisionShape2D4]
	
		
func _integrate_forces(state):
	var velocity = state.get_linear_velocity()
	var step = state.get_step()
	var on_floor = false
	
	for i in range(state.get_contact_count()):
		var contact_normal = state.get_contact_local_normal(i)
		if contact_normal.dot(Vector2(0, -1)) > 0.5:
			on_floor = true

	if on_floor:
		if  Input.is_action_pressed(\"tank2forward\") and not Input.is_action_pressed(\"tank2backward\"):
			velocity.x = max( velocity.x - WALK_ACCEL * step, -WALK_MAX_VELOCITY )
			print(\"tank 2\")
		elif Input.is_action_pressed(\"tank2backward\") and not Input.is_action_pressed(\"tank2forward\"):
			velocity.x = min( velocity.x + WALK_ACCEL * step, WALK_MAX_VELOCITY )
		else:
			var xspeed = max( abs(velocity.x) - WALK_ACCEL * step, 0)
			velocity.x = xspeed * sign(velocity.x)

	

	velocity += state.get_total_gravity() * step
	state.set_linear_velocity(velocity)"

[sub_resource type="RayShape2D" id=2]
length = 155.0

[sub_resource type="RayShape2D" id=3]
length = 155.0

[node name="Tank2" type="RigidBody2D"]
mode = 2
contacts_reported = 3
angular_damp = 18.791
script = SubResource( 1 )

[node name="Tank" type="Sprite" parent="."]
scale = Vector2( -0.2, 0.2 )
texture = ExtResource( 1 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2( -2, 0 )
scale = Vector2( 0.2, 0.2 )
shape = SubResource( 2 )

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="."]
position = Vector2( 0, 1 )
scale = Vector2( -0.2, 0.2 )
polygon = PoolVector2Array( -102, 59, 3, 111, 180, 110, 218, 46, 108, -77 )

[node name="CollisionShape2D2" type="CollisionShape2D" parent="."]
position = Vector2( -42, 0 )
scale = Vector2( 0.2, 0.2 )
shape = SubResource( 3 )

[node name="CollisionShape2D3" type="CollisionShape2D" parent="."]
position = Vector2( -21, 0 )
scale = Vector2( 0.2, 0.2 )
shape = SubResource( 3 )

[node name="CollisionShape2D4" type="CollisionShape2D" parent="."]
position = Vector2( 20, 0 )
scale = Vector2( 0.2, 0.2 )
shape = SubResource( 3 )
